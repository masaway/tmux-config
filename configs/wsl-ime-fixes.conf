# === WSL/Windows Terminal環境でのIME問題対応設定 ===
# この設定ファイルは、Windows Terminal + WSL環境での日本語IME使用時の
# 表示問題（候補ウィンドウの位置ずれ、表示アーティファクト）を軽減します。

# === 基本的な応答性向上設定 ===
# エスケープシーケンスの処理時間を最短に設定
# IME入力時の遅延を最小化
set -sg escape-time 0

# === 文字エンコーディング設定 ===
# UTF-8を強制的に使用
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",*256col*:Tc"

# === 画面再描画の最適化 ===
# 画面の再描画を積極的に行う
set -g assume-paste-time 0
set -g repeat-time 600

# === ステータスバーの更新間隔調整 ===
# ステータスバーの更新を頻繁に行い、表示のちらつきを軽減
set -g status-interval 1

# === Windows Terminal固有の設定 ===
# マウスイベントの処理を最適化
set -g mouse on

# === IME候補ウィンドウとの干渉を最小化 ===
# ペインのタイトル表示を調整（IME候補ウィンドウとの重複を避ける）
set -g pane-border-status off

# === 画面クリア時の処理改善 ===
# 画面クリア時にIMEの状態もリセット
bind C-l send-keys 'C-l' \; clear-history

# === 日本語入力時の表示改善 ===
# 幅の広い文字（日本語）の表示を改善
set -g utf8 on
set -g status-utf8 on

# === Windows Terminal用の色設定 ===
# 背景色を明示的に設定してアーティファクトを防ぐ
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",xterm-256color:RGB"

# === 入力バッファの最適化 ===
# 入力バッファのサイズを調整
set -g buffer-limit 20

# === セッション間でのIME状態の独立性を保つ ===
# 各セッションでIME状態を独立して管理
set -g renumber-windows on

# === デバッグ用設定 ===
# 表示問題のデバッグ時に有効にする
# set -g visual-activity on
# set -g visual-bell on
# set -g visual-silence on